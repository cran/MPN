<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Martine Ferguson &amp; John Ihrie" />

<meta name="date" content="2019-03-20" />

<title>APC: Aerobic Plate Count for Serial Dilutions</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">APC: Aerobic Plate Count for Serial Dilutions</h1>
<h4 class="author"><em>Martine Ferguson &amp; John Ihrie</em></h4>
<h4 class="date"><em>2019-03-20</em></h4>



<p>The <strong>MPN</strong> package includes the <code>apc()</code> function to estimate the Aerobic Plate Count (<em>APC</em>) point estimate and confidence interval. The <em>APC</em> estimates the average density of colony forming units (CFUs) per milliliter. Although other techniques exist (<em>1</em>) to handle agar plate counts that are too-numerous-to-count (TNTC), <code>apc()</code> uses the maximum likelihood technique of Haas &amp; Heller (<em>2</em>) and Haas et al. (<em>3</em>).</p>
<div id="maximum-likelihood-estimation" class="section level2">
<h2>Maximum Likelihood Estimation</h2>
<p>As with the Most Probable Number, the Aerobic Plate Count is estimated by maximizing likelihood. Using a modified version of the notation of Haas et al. (<em>3</em>), we write the likelihood function as:</p>
<p><span class="math display">\[L = \prod_{i=1}^m \frac{{({\lambda}{V_i})} ^ {N_i}}{N_i!}
    {e ^ {-{\lambda}{V_i}}}
    \prod_{j=m+1}^n [1 - \Gamma(N_{L,j}-1, \lambda{V_j})]\]</span></p>
<p>where</p>
<ul>
<li><span class="math inline">\(\lambda\)</span> is the average microbial density (in CFU/ml) to be estimated</li>
<li><span class="math inline">\(m\)</span> is the number of scorable (countable) plates</li>
<li><span class="math inline">\(n\)</span> is the total number of plates</li>
<li><span class="math inline">\(N_i\)</span> is the CFU count at the <span class="math inline">\(i^{th}\)</span> scorable plate</li>
<li><span class="math inline">\(V_i\)</span> is the amount of inoculum (in ml) in the <span class="math inline">\(i^{th}\)</span> scorable plate</li>
<li><span class="math inline">\(N_{L,j}\)</span> is the CFU count limit in the <span class="math inline">\(j^{th}\)</span> plate above which the plate count is considered TNTC</li>
<li><span class="math inline">\(V_j\)</span> is the amount of inoculum (in ml) in the <span class="math inline">\(j^{th}\)</span> TNTC plate</li>
</ul>
<p>As an <em>R</em> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">L &lt;-<span class="st"> </span><span class="cf">function</span>(lambda, count, amount_scor, <span class="dt">amount_tntc =</span> <span class="ot">NULL</span>, <span class="dt">tntc_limit =</span> <span class="dv">100</span>) {
  <span class="co">#likelihood</span>
  scorable &lt;-<span class="st"> </span><span class="kw">prod</span>(<span class="kw">dpois</span>(count, <span class="dt">lambda =</span> lambda <span class="op">*</span><span class="st"> </span>amount_scor))
  <span class="cf">if</span> (<span class="kw">length</span>(amount_tntc) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {
    incomplete_gamma &lt;-<span class="st"> </span><span class="kw">pgamma</span>(tntc_limit <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, lambda <span class="op">*</span><span class="st"> </span>amount_tntc)
    tntc &lt;-<span class="st"> </span><span class="kw">prod</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>incomplete_gamma)
    <span class="kw">return</span>(scorable <span class="op">*</span><span class="st"> </span>tntc)
  } <span class="cf">else</span> {
    <span class="kw">return</span>(scorable)
  }
}
L_vec &lt;-<span class="st"> </span><span class="kw">Vectorize</span>(L, <span class="st">&quot;lambda&quot;</span>)</code></pre></div>
<p><code>apc()</code> actually maximizes the log-likelihood function to solve for <span class="math inline">\(\hat{\lambda}\)</span>, the maximum likelihood estimate (MLE) of <span class="math inline">\(\lambda\)</span> (i.e., the point estimate of <em>APC</em>). However, let’s demonstrate what is happening in terms of the likelihood function itself. Assume we start with four plates and 1 ml of undiluted inoculum. For the first two plates we use a 100-fold dilution; for the other two plates we use a 1,000-fold dilution. The first two plates were TNTC with limits of 300 and 250. The other plates had CFU counts of 28 and 20:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#APC calculation</span>
<span class="kw">library</span>(MPN)
my_count       &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">28</span>, <span class="dv">20</span>)          <span class="co">#Ni</span>
my_amount_scor &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(.<span class="dv">001</span>, .<span class="dv">001</span>)  <span class="co">#Vi</span>
my_amount_tntc &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(.<span class="dv">01</span>, .<span class="dv">01</span>)    <span class="co">#Vj</span>
my_tntc_limit  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">250</span>)        <span class="co">#NLj</span>
(my_apc &lt;-<span class="st"> </span><span class="kw">apc</span>(my_count, my_amount_scor, my_amount_tntc, my_tntc_limit))
<span class="co">#&gt; $APC</span>
<span class="co">#&gt; [1] 30183.83</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $conf_level</span>
<span class="co">#&gt; [1] 0.95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LB</span>
<span class="co">#&gt; [1] 26792.25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $UB</span>
<span class="co">#&gt; [1] 34963.34</span></code></pre></div>
<p>If we plot the likelihood function, we see that <span class="math inline">\(\hat{\lambda}\)</span> maximizes the likelihood:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_apc<span class="op">$</span>APC
<span class="co">#&gt; [1] 30183.83</span>
my_lambda &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">29000</span>, <span class="dv">31500</span>, <span class="dt">length =</span> <span class="dv">1000</span>)
my_L &lt;-<span class="st"> </span><span class="kw">L_vec</span>(my_lambda, my_count, my_amount_scor, my_amount_tntc,
              my_tntc_limit)
<span class="kw">plot</span>(my_lambda, my_L, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Likelihood&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Maximum Likelihood&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> my_apc<span class="op">$</span>APC, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If all of the plates have zero counts, the MLE is zero:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all_zero &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co">#Ni</span>
(apc_all_zero &lt;-<span class="st"> </span><span class="kw">apc</span>(all_zero, my_amount_scor)<span class="op">$</span>APC)
<span class="co">#&gt; [1] 0</span>
my_lambda &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1000</span>, <span class="dt">length =</span> <span class="dv">1000</span>)
L_all_zero  &lt;-<span class="st"> </span><span class="kw">L_vec</span>(my_lambda, all_zero, my_amount_scor)
<span class="kw">plot</span>(my_lambda, L_all_zero, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Likelihood&quot;</span>,
     <span class="dt">main =</span> <span class="st">&quot;All Zeroes&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> apc_all_zero, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="confidence-intervals" class="section level2">
<h2>Confidence Intervals</h2>
<p><code>apc()</code> computes the confidence interval of <span class="math inline">\(\lambda\)</span> using the likelihood ratio approach described in Haas et al. (<em>3</em>). However, since this approach relies on large-sample theory, the results are more reliable for larger experiments.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_count       &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">28</span>, <span class="dv">20</span>)
my_amount_scor &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(.<span class="dv">001</span>, .<span class="dv">001</span>)
my_amount_tntc &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(.<span class="dv">01</span>, .<span class="dv">01</span>)
my_tntc_limit  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">250</span>)
(my_apc &lt;-<span class="st"> </span><span class="kw">apc</span>(my_count, my_amount_scor, my_amount_tntc, my_tntc_limit))
<span class="co">#&gt; $APC</span>
<span class="co">#&gt; [1] 30183.83</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $conf_level</span>
<span class="co">#&gt; [1] 0.95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $LB</span>
<span class="co">#&gt; [1] 26792.25</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $UB</span>
<span class="co">#&gt; [1] 34963.34</span>
my_lambda &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">25000</span>, <span class="dv">36000</span>, <span class="dt">length =</span> <span class="dv">1000</span>)
my_L &lt;-<span class="st"> </span><span class="kw">L_vec</span>(my_lambda, my_count, my_amount_scor, my_amount_tntc,
              my_tntc_limit)
<span class="kw">plot</span>(my_lambda, my_L, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Likelihood&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Maximum Likelihood&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> my_apc<span class="op">$</span>APC, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> my_apc<span class="op">$</span>LB, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> my_apc<span class="op">$</span>UB, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
<div id="references" class="section level3">
<h3>References</h3>
<ol style="list-style-type: decimal">
<li><p>Bacteriological Analytical Manual, 8th Edition, Chapter 3, <a href="https://www.fda.gov/food/foodscienceresearch/laboratorymethods/ucm063346.htm" class="uri">https://www.fda.gov/food/foodscienceresearch/laboratorymethods/ucm063346.htm</a></p></li>
<li><p>Haas CN, Heller B (1988). “Averaging of TNTC counts.” <em>Applied and Environmental Microbiology</em>, 54(8), 2069-2072. <a href="https://aem.asm.org/content/54/8/2069" class="uri">https://aem.asm.org/content/54/8/2069</a></p></li>
<li><p>Haas CN, Rose JB, Gerba CP (2014). “Quantitative microbial risk assessment, Second Ed.” <em>John Wiley &amp; Sons, Inc.</em>, ISBN 978-1-118-14529-6.</p></li>
</ol>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
